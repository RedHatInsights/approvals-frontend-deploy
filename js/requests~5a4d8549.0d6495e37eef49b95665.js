(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{682:function(e,t,n){"use strict";var a=(0,n(208).defineMessages)({requestTitle:{id:"actionModal.requestTitle",defaultMessage:"Request #{id}"},requestActionTitle:{id:"actionModal.requestTitle",defaultMessage:"{actionType} Request #{id}"},actionName:{id:"actionModal.actionName",defaultMessage:"{actionType} Request"},fulfilledAction:{id:"actionModal.fullfiledAction",defaultMessage:"The {actionName} was successful."},failedAction:{id:"actionModal.failedAction",defaultMessage:"The {actionName} action failed."},successTitle:{id:"actionModal.successTitle",defaultMessage:"Success"},failedTitle:{id:"actionModal.failedTitle",defaultMessage:"{actionName} error"}});t.a=a},687:function(e,t,n){"use strict";n.d(t,"e",(function(){return C})),n.d(t,"c",(function(){return _})),n.d(t,"d",(function(){return P})),n.d(t,"b",(function(){return x})),n.d(t,"h",(function(){return F})),n.d(t,"g",(function(){return R})),n.d(t,"a",(function(){return k})),n.d(t,"f",(function(){return A}));var a=n(19),r=n(110),o=n.n(r),c=n(11),s=n.n(c),i=n(170),u=n.n(i),l=n(214),f=n(105),m=n(210),d=n(51);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=Object(l.a)(),g=Object(l.c)(),h=function(e){return{"request-id":"id",opened:"created_at",requester:"requester_name",status:"state"}[e]||e},O=function(e){var t=[];return e.name&&t.push("filter[name][contains_i]=".concat(e.name)),e.requester&&t.push("filter[requester_name][contains_i]=".concat(e.requester)),e.decision&&e.decision.forEach((function(e){t.push("filter[decision][eq][]=".concat(e))})),t.join("&")};function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.b,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r="&limit=".concat(Math.max(t.limit,10),"&offset=").concat(t.offset),o="&sort_by=".concat(h(a.property),":").concat(a.direction),c="".concat(f.a,"/requests/?").concat(O(e)).concat(r).concat(o),s=n?{"x-rh-persona":n}:void 0;return Object(l.b)()({method:"get",url:c,headers:s})}var j=function(e,t){var n,a=t&&t!==d.b?{"x-rh-persona":t}:{"x-rh-persona":d.c};return g({method:"post",url:"".concat(f.a,"/graphql"),headers:a,data:{query:(n=e,'query {\n  requests(id: "'.concat(n,'") {\n    id\n    name\n    number_of_children\n    decision\n    description\n    group_name\n    number_of_finished_children\n    state\n    requester_name\n    actions {\n      id\n      operation\n      comments\n      created_at\n      processed_by\n    }\n    requests {\n      id\n      name\n      number_of_children\n      decision\n      description\n      group_name\n      number_of_finished_children\n      state\n      workflow_id\n      parent_id\n      actions {\n        id\n        operation\n        comments\n        created_at\n        processed_by\n      }\n    }\n  }\n}'))}}).then((function(e){return e.data.requests}))},q=function(e,t){var n="".concat(f.a,"/requests/").concat(e).concat(t?"/requests":""),a={"x-rh-persona":d.c};return Object(l.b)()({method:"get",url:n,headers:a})};function M(e,t){return E.apply(this,arguments)}function E(){return(E=u()(o.a.mark((function e(t,n){var a,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t,n);case 2:if((a=e.sent)&&0!==a.length){e.next=5;break}return e.abrupt("return",{});case 5:if(n!==d.b){e.next=17;break}if(!(a&&a.length>0&&a[0].number_of_children>0)){e.next=13;break}return e.next=9,q(t,!0);case 9:(r=e.sent)&&r.data&&(a[0].requests=a[0].requests.map((function(e){return y(y({},r.data.find((function(t){return t.id===e.id&&t.metadata}))),e)}))),e.next=17;break;case 13:return e.next=15,q(t,!1);case 15:(c=e.sent)&&(a[0]=y(y({},a[0]),{},{metadata:c.metadata}));case 17:return e.abrupt("return",a[0]);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=function(e,t){return b.createAction(e,t)},w=n(682),C=function(e,t){return function(n,r){var o=r().requestReducer,c=o.sortBy,s=o.requests,i=o.filterValue,u=t||m.b;if(!t&&s){var l=s.meta;u={limit:l.limit,offset:l.offset}}return n({type:a.g,payload:v(i,u,e,c)})}},_=function(e,t){return{type:a.f,payload:M(e,t)}},P=function(e,t){return{type:a.h,payload:(n=e,r="".concat(f.a,"/requests/").concat(n,"/content"),o={"x-rh-persona":d.c},Object(l.b)()({method:"get",url:r,headers:o}))};var n,r,o},x=function(e,t,n,r){return{type:a.c,payload:T(t,n),meta:{notifications:{fulfilled:{variant:"success",title:r.formatMessage(w.a.successTitle),description:r.formatMessage(w.a.fulfilledAction,{actionName:e})},rejected:{variant:"danger",title:r.formatMessage(w.a.failedTitle,{actionName:e}),description:r.formatMessage(w.a.failedAction,{actionName:e})}}}}},F=function(e){return{type:a.r,payload:e}},R=function(e,t){return{type:a.p,payload:{filterValue:e,type:t}}},k=function(){return{type:a.b}},A=function(){return{type:a.o}}},699:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(9),c=n.n(o),s=n(286),i=n(209),u=n(75),l=n(82),f=n(51),m=function(e){var t=e.denyLink,n=e.approveLink,a=e.commentLink,o=e.request,c=e.canApproveDeny,m=e.canComment,d=Object(s.a)(),p=o.id,y=o.state,b=Object(f.f)(y)&&c,g=Object(f.f)(y)&&m;return r.a.createElement("div",{style:{display:"flex"}},b&&r.a.createElement(r.a.Fragment,null,r.a.createElement(u.b,{to:{pathname:n,search:"request=".concat(p)},className:"pf-u-mr-sm",id:"approve-".concat(o.id)},r.a.createElement(i.Button,{variant:"primary","aria-label":d.formatMessage(l.a.approveRequest)},d.formatMessage(l.a.approveTitle))),r.a.createElement(u.b,{to:{pathname:t,search:"request=".concat(p)},className:"pf-u-mr-sm",id:"deny-".concat(o.id)},r.a.createElement(i.Button,{variant:"danger","aria-label":d.formatMessage(l.a.denyTitle)},d.formatMessage(l.a.denyTitle)))),g&&r.a.createElement(u.b,{to:{pathname:a,search:"request=".concat(p)},id:"comment-".concat(o.id)},r.a.createElement(i.Button,{variant:"secondary","aria-label":d.formatMessage(l.a.commentTitle)},d.formatMessage(l.a.commentTitle))))};m.propTypes={denyLink:c.a.string,approveLink:c.a.string,commentLink:c.a.string,request:c.a.object.isRequired,canApproveDeny:c.a.bool,canComment:c.a.bool},m.defaultProps={canApproveDeny:!0,canComment:!0},t.a=m},715:function(e,t,n){"use strict";var a=n(11),r=n.n(a),o=n(102),c=n.n(o),s=n(0),i=n.n(s),u=n(9),l=n.n(u),f=n(691),m=n(23),d=n(121),p=n(224),y=n(626),b=n(687),g=n(676),h=n.n(g),O=n(685),v=n.n(O),j=n(82);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return{fields:[M({component:h.a.TEXTAREA,name:"comments",isRequired:e,label:e?t.formatMessage(j.a.reasonTitle):t.formatMessage(j.a.commentTitle)},e&&{validate:[{type:v.a.REQUIRED}]})]}},T=n(677),w=n(65),C=n(286),_=n(682);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F={Approve:j.a.approveTitle,Deny:j.a.denyTitle},R=function(e){var t=e.actionType,n=e.createRequestAction,a=e.closeUrl,r=e.postMethod,o=Object(C.a)(),s=Object(m.g)().push,u=Object(T.a)(["request"]),l=c()(u,1)[0].request,d=function(){return s(a)};return i.a.createElement(y.Modal,{variant:"large",title:"Add Comment"===t?o.formatMessage(_.a.requestTitle,{id:l}):o.formatMessage(_.a.requestActionTitle,{id:l,actionType:o.formatMessage(F[t])}),isOpen:!0,onClose:d},i.a.createElement(f.a,{schema:E("Deny"===t,o),onSubmit:function(e){var c={"Add Comment":"memo",Approve:"approve",Deny:"deny"},i="Add Comment"===t?o.formatMessage(j.a.addCommentTitle):o.formatMessage(_.a.actionName,{actionType:o.formatMessage(F[t])});return r?n(i,l,x({operation:c[t]},e),o).then((function(){return r()})).then((function(){return s(a)})):n(i,l,x({operation:c[t]},e),o).then((function(){return s(a)}))},onCancel:d}))};R.defaultProps={closeUrl:w.a.requests.index},R.propTypes={createRequestAction:l.a.func.isRequired,postMethod:l.a.func,actionType:l.a.string,closeUrl:l.a.oneOfType([l.a.string,l.a.shape({patname:l.a.string,search:l.a.string})])};t.a=Object(d.connect)(null,(function(e){return Object(p.a)({createRequestAction:b.b},e)}))(R)},740:function(e,t,n){"use strict";var a=n(211),r=n.n(a),o=n(102),c=n.n(o),s=n(11),i=n.n(s),u=n(0),l=n.n(u),f=n(9),m=n.n(f),d=n(121),p=n(209),y=n(301),b=n(303),g=n(85),h=n(286),O=n(625),v=n.n(O),j=n(716),q=n.n(j),M=n(687),E=n(122),T=n.n(E),w=n(75),C=n(51),_=n(65),P=n(635),x=n(105),F=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},R=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_.a.request,a=arguments.length>3?arguments[3]:void 0;return t.reduce((function(t,r){var o,c,s;return[].concat(T()(t),[{id:r.id,state:r.state,number_of_children:r.number_of_children,cells:[l.a.createElement(u.Fragment,{key:r.id},l.a.createElement(w.b,{to:{pathname:n.index,search:"?request=".concat(r.id)}},r.id)),r.name,r.requester_name,r.finished_at?Object(C.h)(r.finished_at):r.notified_at?Object(C.h)(r.notified_at):Object(C.h)(r.created_at),l.a.createElement(u.Fragment,{key:"decision-".concat(r.id)},e(r)||l.a.createElement(P.Label,{variant:"outline",icon:null===(o=x.d[r.decision])||void 0===o?void 0:o.icon,color:null===(c=x.d[r.decision])||void 0===c?void 0:c.color},F(a.formatMessage((null===(s=x.d[r.decision])||void 0===s?void 0:s.displayName)||Object(x.e)()))))]}])}),[])},k=n(730),A=n(166),D=n(700),V=n(686),S=n(741),N=n(66),L=n(690),B=n(82),U=function(e,t){var n=e.name,a=e.requester,r=e.decision;return[].concat(T()(n?[{category:t.formatMessage(L.a.name),key:"name",chips:[{name:n,value:n}]}]:[]),T()(a?[{category:t.formatMessage(B.a.requesterColumn),key:"requester",chips:[{name:a,value:a}]}]:[]),T()(r&&r.length>0?[{category:t.formatMessage(B.a.statusColumn),key:"decision",chips:r.map((function(e){return{name:e,value:e}}))}]:[]))},I=n(674),J=n(23),Q=n(715);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(e){return[{title:e.formatMessage(B.a.requestsIdColumn),transforms:[y.a,Object(b.a)(10)]},{title:e.formatMessage(L.a.name),transforms:[y.a,g.e,Object(b.a)(25)],cellTransforms:[g.a]},{title:e.formatMessage(B.a.requesterColumn),transforms:[y.a,g.e,Object(b.a)(25)]},{title:e.formatMessage(B.a.updatedColumn),transforms:[Object(b.a)(15)]},{title:e.formatMessage(B.a.statusColumn),transforms:[y.a,Object(b.a)(25)]}]},H=Object(V.a)((function(e,t,n,a){return t(!0),a&&a(),e(Object(M.e)(n)).then((function(){return t(!1)}))}),1e3),K=function(e,t){switch(t.type){case"setFetching":return z(z({},e),{},{isFetching:t.payload});case"setNameValue":return z(z({},e),{},{nameValue:t.payload});case"setRequesterValue":return z(z({},e),{},{requesterValue:t.payload});case"clearFilters":return z(z({},e),{},{requesterValue:"",nameValue:"",isFetching:!0});case"setFilteringFlag":return z(z({},e),{},{isFiltering:t.payload});case"setRows":return z(z({},e),{},{rows:t.payload});default:return e}},W=function(e){var t=e.persona,n=e.indexpath,a=e.actionResolver,o=Object(d.useSelector)((function(e){var t=e.requestReducer;return{requests:t.requests,sortBy:t.sortBy,filterValue:t.filterValue}}),d.shallowEqual),s=o.requests,i=s.data,f=s.meta,m=o.sortBy,y=o.filterValue,b=Object(u.useReducer)(K,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{nameValue:e,requesterValue:t,isOpen:!1,isFetching:!0,isFiltering:!1,rows:[]}}(y.name,y.requester)),g=c()(b,2),O=g[0],j=O.nameValue,E=O.isFetching,T=O.isFiltering,w=O.requesterValue,P=O.rows,x=g[1],F=Object(u.useContext)(N.a).userRoles,V=Object(d.useDispatch)(),X=Object(h.a)(),z=Object(C.i)(F),W=Object(C.j)(F),Y=function(e){if(W||t!==C.b)return x({type:"setFetching",payload:!0}),V(Object(M.e)(t,e)).then((function(){return x({type:"setFetching",payload:!1})})).catch((function(){return x({type:"setFetching",payload:!1})}));x({type:"setFetching",payload:!1})};Object(u.useEffect)((function(){V(Object(M.f)()),Y(),Object(C.g)()}),[t]),Object(u.useEffect)((function(){x({type:"setRows",payload:R(a,i,n,X)})}),[i]);var Z=function(e,n){var a=!1;return"name"===n?(x({type:"setNameValue",payload:e}),a=!0):"requester"===n&&(x({type:"setRequesterValue",payload:e}),a=!0),a||V(Object(M.g)(e,n)),H(V,(function(e){return x({type:"setFilteringFlag",payload:e})}),t,a&&function(){return V(Object(M.g)(e,n))})},$=function(){return x({type:"clearFilters"}),V(Object(M.a)()),Y()};return l.a.createElement(u.Fragment,null,l.a.createElement(A.a,null,l.a.createElement(A.b,{title:X.formatMessage(I.a.approvalTitle)}),z&&l.a.createElement(D.a,null)),l.a.createElement(k.a,{sortBy:m,onSort:function(e,t,n,a){var r=a.property;return x({type:"setFetching",payload:!0}),V(Object(M.h)({index:t,direction:n,property:r})),Y()},rows:P,columns:G(X),fetchData:Y,routes:function(){return l.a.createElement(u.Fragment,null,l.a.createElement(J.b,{exact:!0,path:_.a.requests.addComment,render:function(e){return l.a.createElement(Q.a,r()({},e,{actionType:"Add Comment",postMethod:function(){return Y(f)}}))}}),l.a.createElement(J.b,{exact:!0,path:_.a.requests.approve,render:function(e){return l.a.createElement(Q.a,r()({},e,{actionType:"Approve",postMethod:function(){return Y(f)}}))}}),l.a.createElement(J.b,{exact:!0,path:_.a.requests.deny,render:function(e){return l.a.createElement(Q.a,r()({},e,{actionType:"Deny",postMethod:function(){return Y(f)}}))}}))},titlePlural:X.formatMessage(B.a.requests),titleSingular:X.formatMessage(B.a.request),pagination:f,handlePagination:Y,filterValue:j,onFilterChange:function(e){return Z(e,"name")},isLoading:E||T,renderEmptyState:function(){return l.a.createElement(S.a,{title:q()(y)?X.formatMessage(L.a.noResultsFound,{results:X.formatMessage(B.a.requests)}):X.formatMessage(L.a.noResultsFound),Icon:v.a,PrimaryAction:function(){return q()(y)?null:l.a.createElement(p.Button,{onClick:$,variant:"link"},X.formatMessage(L.a.clearAllFilters))},description:q()(y)?"":X.formatMessage(L.a.clearAllFiltersDescription)})},activeFiltersConfig:{filters:U({name:j,requester:w,decision:y.decision},X),onDelete:function(e,t,n){return n?$():(a=t,r=c()(a,1)[0],o=r.key,s=c()(r.chips,1)[0].value,i=["name","requester"].includes(o)?"":y[o].filter((function(e){return s!==e})),void Z(i,o));var a,r,o,s,i}},filterConfig:[{label:X.formatMessage(B.a.requesterColumn),filterValues:{placeholder:X.formatMessage(L.a.filterByTitle,{title:X.formatMessage(B.a.requesterColumn).toLowerCase()}),"aria-label":X.formatMessage(L.a.filterByTitle,{title:X.formatMessage(B.a.requesterColumn).toLowerCase()}),onChange:function(e,t){return Z(t,"requester")},value:w}},{label:X.formatMessage(B.a.statusColumn),type:"checkbox",filterValues:{placeholder:X.formatMessage(L.a.filterByTitle,{title:X.formatMessage(B.a.statusColumn).toLowerCase()}),"aria-label":X.formatMessage(L.a.filterByTitle,{title:X.formatMessage(B.a.statusColumn).toLowerCase()}),onChange:function(e,t){return Z(t,"decision")},value:y.decision,items:["approved","canceled","denied","error","undecided"].map((function(e){return{label:X.formatMessage(B.a[e]),value:e}}))}}]}))};W.propTypes={routes:m.a.func,persona:m.a.string,indexpath:m.a.shape({index:m.a.string}),actionResolver:m.a.func},W.defaultProps={indexpath:_.a.request,actionResolver:function(){return!1}};t.a=W},807:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(51),c=n(740),s=n(65);t.default=function(){return r.a.createElement(c.a,{persona:o.a,indexpath:s.a.allrequest})}},809:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(51),c=n(66),s=n(65),i=n(740),u=n(625),l=n.n(u),f=n(166),m=n(700),d=n(629),p=n(631),y=n(630),b=n(633),g=n(74),h=n(120),O=n(286),v=n(82),j=n(674),q=function(){var e=Object(a.useContext)(c.a).userRoles,t=Object(o.i)(e),n=Object(O.a)();return r.a.createElement(a.Fragment,null,r.a.createElement(f.a,null,r.a.createElement(f.b,{title:n.formatMessage(j.a.approvalTitle)}),t&&r.a.createElement(m.a,null)),r.a.createElement("div",{className:"pf-u-mt-xl"},r.a.createElement(d.EmptyState,{className:"pf-u-ml-auto pf-u-mr-auto"},r.a.createElement(y.EmptyStateIcon,{icon:l.a}),r.a.createElement(h.TextContent,null,r.a.createElement(g.Text,{component:g.TextVariants.h1},n.formatMessage(v.a.emptyRequestsTitle))),r.a.createElement(p.EmptyStateBody,null,n.formatMessage(v.a.emptyRequestsDescription))),r.a.createElement(b.EmptyStateSecondaryActions,null)))},M=n(699);t.default=function(){var e=Object(a.useContext)(c.a).userRoles,t=Object(o.i)(e),n=Object(o.j)(e);return n?r.a.createElement(i.a,{persona:o.b,actionResolver:function(e){return e&&e.id&&(!(a=e)||!a.state||!Object(o.f)(a.state)||a.number_of_children>0||!n&&!t)?null:r.a.createElement(M.a,{commentLink:s.a.requests.addComment,approveLink:s.a.requests.approve,denyLink:s.a.requests.deny,request:e});var a}}):r.a.createElement(q,null)}}}]);
//# sourceMappingURL=../sourcemaps/requests~5a4d8549.js.map